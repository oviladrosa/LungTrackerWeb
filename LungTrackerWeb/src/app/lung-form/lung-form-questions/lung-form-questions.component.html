<div style="width: 100%;" fxLayout="row" class="mat-typography">
 <div  fxFlex="20" >
    <div class="append-menu" fxLayout="column">
      <span class="form-item" [class.light-text]="this.step==1">01. Datos demográficos</span>
      <span class="form-item" [class.light-text]="this.step==2">02. Historial clínico</span>
      <span class="form-item" [class.light-text]="this.step==3">03. Exposición a tóxicos contaminantes</span>
      <span class="form-item" [class.light-text]="this.step==4">04. Historial laboral</span>
      <span class="form-item" [class.light-text]="this.step==5">05. Historial familiar</span>
    </div>

 </div>
 <div fxFlex="80">
    <div style="width: 100%;">
      <h1 class="form-title">{{this.getTitle()}}</h1>
      <span class="nsnc-informer">Para cualquier respuesta que desconozcas encontrarás la opción <i>NS/NC</i>.</span>
    </div>
    <mat-horizontal-stepper  #stepper>

      <mat-step [stepControl]="demographicDetails" [editable]="true">
         <div class="questions-div">
            <form [formGroup]="demographicDetails">
               <h2>Información personal</h2>
               <div style="width: 100%;" fxLayout.gt-sm="row" fxLayout="column">
                  <mat-form-field appearance="outline" fxFlex.gt-sm="30">
                     <mat-label>Data de naixement</mat-label>
                     <input matInput formControlName="birthDate" required type="date">
                   
                   </mat-form-field>
                   <mat-form-field appearance="outline" fxFlex.gt-sm="30" fxFlexOffset.gt-sm="10">
                      <mat-label>Sexo</mat-label>
                      <select  matNativeControl  formControlName="gender" matInput>
                         <option value="" disabled>Indica tu sexo</option>
                         <option *ngFor="let gen of generos" [ngValue]="gen">{{gen}}</option>
                      </select>
                    </mat-form-field>
               </div>
               
                <h2>Lugar de residencia</h2>

                <mat-form-field appearance="outline" >
                  <mat-label>País de residencia</mat-label>
                  <select  matNativeControl  formControlName="residenceCountry" matInput (change)="changeRegions()">
                     <option value="" disabled>Indica el país</option>
                     <option *ngFor="let c of countries" [ngValue]="c">{{c.name}}</option>
                  </select>
                
                </mat-form-field>
                <mat-form-field appearance="outline" >
                  <mat-label>Región de residencia</mat-label>
                  <select  matNativeControl  formControlName="residenceRegion" matInput (change)="changeCities()">
                     <option value="" disabled>Indica la región</option>
                     <option *ngFor="let r of regions" [ngValue]="r">{{r.name}}</option>
                  </select>
                
                </mat-form-field>
                <mat-form-field appearance="outline" >
                  <mat-label>Ciudad de residencia</mat-label>
                  <select  matNativeControl  formControlName="residenceCity" matInput>
                     <option value="" disabled>Indica la ciutad</option>
                     <option *ngFor="let c of cities" [ngValue]="c">{{c.name}}</option>
                  </select>
                
                </mat-form-field>
                <mat-form-field appearance="outline">
                  <mat-label>Código postal</mat-label>
                  <input matInput formControlName="residencePostCode" required type="number">
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Año inicial</mat-label>
                  <input matInput formControlName="residenceInitialYears" required type="number">
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Año final</mat-label>
                  <input matInput formControlName="residenceEndYears" required type="number">
                </mat-form-field>

                <!-- Born Form Questions -->
                <h2>Lugar de nacimiento</h2>

                <mat-form-field appearance="outline">
                  <mat-label>País</mat-label>
                  <select  matNativeControl  formControlName="bornCountry" matInput (change)="changeBornRegions()">
                     <option value="" disabled>Indica el país</option>
                     <option *ngFor="let c of bornCountries" [ngValue]="c">{{c.name}}</option>
                  </select>
                
                </mat-form-field>
                <mat-form-field appearance="outline" >
                  <mat-label>Región de residencia</mat-label>
                  <select  matNativeControl  formControlName="bornRegion" matInput (change)="changeBornCities()">
                     <option value="" disabled>Indica la región</option>
                     <option *ngFor="let r of bornRegions" [ngValue]="r">{{r.name}}</option>
                  </select>
                
                </mat-form-field>
                <mat-form-field appearance="outline" >
                  <mat-label>Ciudad de residencia</mat-label>
                  <select  matNativeControl  formControlName="bornCity" matInput>
                     <option value="" disabled>Indica la ciudad</option>
                     <option *ngFor="let c of bornCities" [ngValue]="c">{{c.name}}</option>
                  </select>
                
                </mat-form-field>
                <mat-form-field appearance="outline">
                  <mat-label>Código postal</mat-label>
                  <input matInput formControlName="bornPostCode" required type="number">
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Año inicial</mat-label>
                  <input matInput formControlName="bornInitialYears" required type="number">
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Año final</mat-label>
                  <input matInput formControlName="bornEndYears" required type="number">
                </mat-form-field>
               <div>
                  <button mat-button matStepperNext (click)="this.next()" [disabled]="this.demographicDetails.invalid">Siguiente</button>
               </div>
             </form>
         </div>
      </mat-step>
      <mat-step  [stepControl]="clinicDetails" [editable]="true">
        <div class="questions-div">
           <form [formGroup]="clinicDetails">
              <h2>Diagnóstico</h2>
              <mat-form-field appearance="outline">
                 <mat-label>Año diágnostico</mat-label>
                 <input matInput formControlName="yearDiagnose" required type="number">
               </mat-form-field>
               <mat-form-field appearance="outline" >
                 <mat-label>Tipo de cáncer</mat-label>
                 <select  matNativeControl  formControlName="cancerType" matInput (change)="enableOtherCancerField()">
                    <option value="" disabled>Indica el tipo</option>
                    <option *ngFor="let t of cancerTypes" [ngValue]="t">{{t}}</option>
                 </select>
               
               </mat-form-field>
               <mat-form-field appearance="outline" >
                 <mat-label>Otros</mat-label>
                 <input matInput formControlName="otherCancerType" type="text">
               </mat-form-field>
               <h3>¿Sabe si se ha detectado alguna mutación en su tumor?</h3>
               <mat-form-field appearance="outline" >
                 <mat-label>Respuesta</mat-label>
                 <select  matNativeControl  formControlName="mutationAnswer" matInput (change)="enableMutationType()">
                    <option value="" disabled>Indica la respuesta</option>
                    <option *ngFor="let t of mutationAnswer" [ngValue]="t">{{t}}</option>
                 </select>
               </mat-form-field>

               <mat-form-field appearance="outline" >
                 <mat-label>Tipo de mutación</mat-label>
                 <select  matNativeControl  formControlName="mutationType" matInput (change)="enableOtherMutationType()">
                    <option value="" disabled>Indica el tipo</option>
                    <option *ngFor="let t of mutationTypes" [ngValue]="t">{{t}}</option>
                 </select>
               </mat-form-field>
               <mat-form-field appearance="outline" >
                 <mat-label>Otros</mat-label>
                 <input matInput formControlName="otherMutationType" type="text">
               </mat-form-field>
               <h3>¿Se ha operado su tumor de pulmón?</h3>
               <mat-form-field appearance="outline" >
                 <mat-label>Respuesta</mat-label>
                 <select  matNativeControl  formControlName="sugeryAnswer" matInput (change)="enableSurgeryYear()">
                    <option value="" disabled>Indica la respuesta</option>
                    <option *ngFor="let t of surgeryAnswers" [ngValue]="t">{{t}}</option>
                 </select>
               </mat-form-field>
               <mat-form-field appearance="outline">
                 <mat-label>Año de la operación</mat-label>
                 <input matInput formControlName="surgeryYear" required type="number">
               </mat-form-field>
               <mat-form-field appearance="outline" >
                 <mat-label>Tratamiento complementario</mat-label>
                 <select  matNativeControl  formControlName="surgeryExtraTreatment" matInput>
                    <option value="" disabled>Indica la respuesta</option>
                    <option *ngFor="let t of surgeryExtraTreatments" [ngValue]="t">{{t}}</option>
                 </select>
               </mat-form-field>
               <h3>¿Su tumor ha desarrollado metástasis?</h3>
               <mat-form-field appearance="outline" >
                 <mat-label>Respuesta</mat-label>
                 <select  matNativeControl  formControlName="metastasisAnswer" matInput (change)="enableMetastasisTypes()">
                    <option value="" disabled>Indica la respuesta</option>
                    <option *ngFor="let t of surgeryAnswers" [ngValue]="t">{{t}}</option>
                 </select>
               </mat-form-field>
               <mat-form-field appearance="outline">
                 <mat-label>Año de la metástasis</mat-label>
                 <input matInput formControlName="metastasisYear" required type="number">
               </mat-form-field>
               <mat-form-field appearance="outline" >
                 <mat-label>Tratamiento</mat-label>
                 <select  matNativeControl  formControlName="metastatisTreatment" matInput (change)="enableOtherMetastasis()">
                    <option value="" disabled>Indica el tratamiento</option>
                    <option *ngFor="let t of metastasisOptions" [ngValue]="t">{{t}}</option>
                 </select>
               </mat-form-field>
               <mat-form-field appearance="outline" >
                 <mat-label>Otros tratamientos</mat-label>
                 <input matInput formControlName="otherMetastasisTreatment" type="text">
               </mat-form-field>
               <h3>(No operado - No metástasis) ¿Ha realizado algún tratamiento (no cirugía)?</h3>
               <mat-form-field appearance="outline" >
                 <mat-label>Respuesta</mat-label>
                 <select  matNativeControl  formControlName="noSurgeryTreatmentAnswer" matInput (change)="enableOtherMetastasisTreatments()">
                    <option value="" disabled>Indica la respuesta</option>
                    <option *ngFor="let t of otherMetastasisTreatments" [ngValue]="t">{{t}}</option>
                 </select>
               </mat-form-field>
               <mat-form-field appearance="outline" >
                 <mat-label>Otros tratamientos</mat-label>
                 <input matInput formControlName="otherNonSurgeryTreatment" type="text">
               </mat-form-field>

               <h3>¿Le han diagnosticado alguna enfermedad pulmonar previa al cáncer de pulmón?</h3>
               <mat-form-field appearance="fill">
                <mat-label>Enfermedades previas</mat-label>
                <mat-select  formControlName="previousDiseases" multiple>
                   <mat-option *ngFor="let t of previousDiseasesOptions" [value]="t">{{t}}</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" >
                <mat-label>Otros</mat-label>
                <input matInput formControlName="otherPreviousDiseases" type="text">
              </mat-form-field>

               <h2>Datos de otros tumores</h2>
               <h3>Aparte del cáncer de pulmón, ¿se le ha diagnosticado otro tipo de cáncer?
              </h3>
              <mat-form-field appearance="outline" >
                <mat-label>Respuesta</mat-label>
                <select  matNativeControl  formControlName="additionalDiagnoseAnswer" matInput>
                   <option value="" disabled>Indica la respuesta</option>
                   <option *ngFor="let t of surgeryAnswers" [ngValue]="t">{{t}}</option>
                </select>
              </mat-form-field>
              <div fxLayout="column">
                <span>Para cada tipo de càncer que haya experimentado añada una pestaña y rellene los datos relacionados.</span>
                <div fxLayout="row" fxLayoutAlign="center center">
                  <button mat-button type="button" (click)="addCancerItem()" >Añadir</button>
                  <button mat-button type="button" (click)="deleteCancerItem()">Eliminar</button>
                </div>
              </div>
              
              
              <div formArrayName="otherCancers"
                *ngFor="let item of getOtherCancers['controls']; let i = index;"
               class="cancerType">
                <div [formGroupName]="i" >
                  <h3>Tipo de càncer - {{i+1}}</h3>
                  <mat-form-field appearance="outline" >
                    <mat-label>Tipo de càncer</mat-label>
                    <select  matNativeControl  formControlName="type" matInput >
                       <option value="" disabled>Indica el tipo</option>
                       <option value="" >Hola</option>
                       <option *ngFor="let o of otherCancerTypes" [ngValue]="o">{{o}}</option>
                    </select>
                  </mat-form-field>
                  <mat-form-field appearance="outline">
                    <mat-label>Año de diágnostico</mat-label>
                    <input matInput formControlName="year" required type="number">
                  </mat-form-field>
                  <mat-form-field appearance="outline" >
                    <mat-label>Ha desarrolado metastasis?</mat-label>
                    <select  matNativeControl  formControlName="metastasis" matInput>
                       <option value="" disabled>Indica la respuesta</option>
                       <option *ngFor="let t of surgeryAnswers" [ngValue]="t">{{t}}</option>
                    </select>
                  </mat-form-field>
                  <mat-form-field appearance="outline">
                    <mat-label>Año de la metastasis</mat-label>
                    <input matInput formControlName="metastasisYear" required type="number">
                  </mat-form-field>
                  <mat-form-field appearance="outline" >
                    <mat-label>Ha realizado tratamiento?</mat-label>
                    <select  matNativeControl  formControlName="treatmentAnswer" matInput>
                       <option value="" disabled>Indica la respuesta</option>
                       <option *ngFor="let t of surgeryAnswers" [ngValue]="t">{{t}}</option>
                    </select>
                  </mat-form-field>
                  <mat-form-field appearance="outline" >
                    <mat-label>Qué tipo de tratamiento?</mat-label>
                    <select  matNativeControl  formControlName="treatmentType" matInput>
                       <option value="" disabled>Indica la respuesta</option>
                       <option *ngFor="let t of otherCancerTreatments" [ngValue]="t">{{t}}</option>
                    </select>
                  </mat-form-field>
                </div>
              </div>

              <div>
                 <button mat-button matStepperPrevious (click)="this.previous()">Anterior</button>
              </div>
              <div>
                 <button mat-button matStepperNext (click)="this.next()" [disabled]="this.clinicDetails.invalid">Siguiente</button>
              </div>
           </form>
        </div>
     </mat-step>
      
   </mat-horizontal-stepper>
   
 </div>
</div>
